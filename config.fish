if status is-interactive
    # Commands to run in interactive sessions can go here
end

# disable welcome messages on fish
set fish_greeting

# set SHELL variable
set -gx SHELL /usr/bin/fish

#use bash's aliases
source ~/.bash_aliases

# source fish's aliases
# source ~/.config/fish/.fish_aliases

# Some experimental key bind
# bind \co 'bat /opt/shell/list_of_all_msfvenom_payloads.txt | fzf'

# Use createbox shell to create a directory and tmux command to set env. variables.
# When SCREENSHOT env. variable is set, text-based screenshot is taken. 

#preexec functions
function my_preexec --on-event fish_preexec
 if set -q SCREENSHOT
  if not string match --quiet -r '^rm|^ls|^cat|^cd' $argv[1] 
   if set -q PROJECT
    set path_log $PROJECT/logs
   else
    set path_log $HOME
   end
   tmux pipe-pane -o "cat >> $path_log/tmux_log.#S:#I-#P_tmp.log"
   echo ">" $argv[1] 
  end
 end
end

#postexec functions
function my_postexec --on-event fish_postexec
 if set -q SCREENSHOT
  if not string match --quiet -r '^rm|^ls|^cat|^cd |^set' $argv[1]
   if set -q PROJECT
    set path_log $PROJECT/logs
    set path_pic $PROJECT/screenshots/
   else
    set path_log $HOME
    set path_pic $HOME/Pictures/
   end
   tmux pipe-pane \;
   set val (echo $argv[1] | sed -E "s/[[:punct:]]|[[:space:]]/_/g")
   set date (date +%Y%m%d-%H%M%S)
   set dest $path_log/tmux_log_(date +%Y%m%d-%H%M%S)_(echo $val).log
   mv -f $path_log/tmux_log.*_tmp.log $dest
   #flameshot screen -p $path_pic
  end
 end
end
